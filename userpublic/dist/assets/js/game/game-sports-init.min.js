!function(t,e){function a(e){var a=t("#J-form");return a.find('[name="gameData"]').val(e.orders),a.find('[name="gameExtra"]').val(e.selects),a.find('[name="betTimes"]').val(e.multiple),e}function s(){var e=t("#J-order-type .list"),a=null,s=6;a=setInterval(function(){s>0?s%2==0?e.addClass("list-blink"):e.removeClass("list-blink"):(e.removeClass("list-blink"),clearInterval(a)),s--},100)}var i=new bomao.SportsGame;i.initOption(global_sports_config.option),i.setMatchTypeValue(t.trim(t("#J-match-method-type-value").val())),i.setMethodMixMaxCfg({win:8,handicapWin:8,haFu:4,correctScore:4,totalGoals:6});var l=t("#J-order-list-cont"),n=t("#J-game-match"),o=e.Message.getInstance(),c=e.Mask.getInstance(),r=e.Tip.getInstance();i.getMultiple=function(){return Number(t("#J-input-multiple").val())},t("#J-input-multiple").keyup(function(){var t=Number(this.value.replace(/[^\d]/g,""));t=1>t?1:t,t=t>Number(global_sports_config_max.MaxMultiple)?Number(global_sports_config_max.MaxMultiple):t,this.value=t,i.updateStatics()}),t("#J-ct-multiple-reduce").click(function(){var e=i.getMultiple();e-=1,e=0>=e?1:e,t("#J-input-multiple").val(e),i.updateStatics()}),t("#J-ct-multiple-add").click(function(){var e=i.getMultiple();e+=1,t("#J-input-multiple").val(e),i.updateStatics()});var d=function(){var a,s,n,o=i,c=o.copyRebuildOrders(o.getOrders()),r=0,d=c.length,u=0,h="",m=t.trim(t("#J-orders-row-tpl").html()),f=[],p=[];for(r=0;d>r;r++){for(n=c[r].bets[0],h=e.util.template(m,n),p=[],u=0,a=c[r].bets.length;a>u;u++)s=c[r].bets[u],p.push('<span data-matchid="'+s.matchid+'" data-type="'+s.type+'" data-value="'+s.value+'" class="o-bet o-bet-'+s.type+" o-bet-"+s.type+"-"+s.value+'">'+s.name+'<b class="one-del">x</b></span>');h=h.replace(/<#=items#>/g,p.join("")),h=h.replace(/<#=dancls#>/g,1==c[r].dan?"dan-active":""),f.push(h)}l.html(f.join(""))};i.addEvent("after_addOrder",d),i.addEvent("after_delBet",function(t,e,a,s){d(),n.find(".row-list-"+e).find(".method-"+a).find('[data-value="'+s+'"]').removeClass("item-active")});var u=function(e,a,s){var i=e.offset(),l=a.offset();a.hide(),s.css({left:i.left,top:i.top,opacity:0}),s.animate({left:l.left,top:l.top,opacity:1},300,function(){s.remove(),a.show(),t("#J-order-list-cont").scrollTop(1e4)})};i.addEvent("after_addOrder",function(){if(f){var t=f,e=t.attr("data-param"),a=m(e),s=a.matchid,i=a.type,n=a.value,o=l.find(".o-match-"+s).find(".o-bet-"+i+"-"+n),c=o.clone().addClass("global-fly-bet");c.appendTo(document.body),u(f,o,c)}}),l.on("click",".fa-times-circle",function(e){var a=t(this),s=a.attr("data-matchid");i.delOrder(s)}),l.on("click",".dan",function(e){var a=t(this),s=a.attr("data-matchid"),l="dan-active";a.hasClass(l)?(a.removeClass(l),i.setDan(s,0)):(a.addClass(l),i.setDan(s,1))}),i.addEvent("after_delOrder",function(t,e){var a="item-active";l.find(".o-match-"+e).remove(),n.find(".row-list-"+e).find(".item").removeClass(a),h()}),i.addEvent("after_delAll",function(t,e){var a="item-active";l.find(".o-match").remove(),n.find(".row-list").find(".item").removeClass(a),h()}),l.on("click",".o-bet",function(){var e=t(this),a=e.attr("data-matchid"),s=e.attr("data-type"),l=e.attr("data-value");i.delBet(a,s,l),h()});var h=function(){l.children().size()<1?t("#J-button-clearall").addClass("ct-clearall-disabled"):t("#J-button-clearall").removeClass("ct-clearall-disabled")};t("#J-button-clearall").click(function(t){t.preventDefault(),i.delAll()}),n.on("click",".item-more",function(){var e=t(this),a=e.attr("data-matchid"),s=n.find(".row-list-"+a),i="row-list-active",l=e.attr("data-desc"),o=e.attr("data-asc");s.hasClass(i)?(s.removeClass(i),e.html(l+' <i class="fa fa-sort-desc"></i>')):(s.addClass(i),e.html(o+' <i class="fa fa-sort-asc"></i>'))}),i.addEvent("after_update",function(e){var a=this,s=a.getSelects(),i=(a.getOrders(),a.getTabType()),l=a.getTypeOption(a.getOrdersLen(),0==i?!1:!0),n=t("#J-order-type").find(".list").hide().eq(i).show(),o=0,c=l.length,r="",d=[];for(o=0;c>o;o++)r=s[l[o].code]?' checked="checked" ':"",d.push("<label><input "+r+' class="ct-select" data-code="'+l[o].code+'" type="checkbox" value="'+l[o].code+'" /> '+l[o].name+"</label>");n.html(d.join(""))}),i.addEvent("after_update_statics",function(){var a=this,s=a.getMultiple(),i=a.getCount();t("#J-times-match").text(a.getOrdersLen()),t("#J-bets-num").text(i),t("#J-money-num").text(e.util.formatMoney(i*s*2))}),i.addEvent("after_countMaxPrize",function(a,s){var i=this,l=i.getMaxPrize();t("#J-prize-max").text(e.util.formatMoney(l))}),t("#J-order-type").find(".tab li").click(function(){var e=t(this),a=t("#J-order-type").find(".tab li").index(this);a!=i.getTabType()&&(t("#J-order-type").find(".tab li").removeClass("active"),e.addClass("active"),i.setTabType(a))}),t("#J-order-type").on("click",".ct-select",function(){var e=t(this),a=e.parent().parent().find(".ct-select"),s=[];"1_1"==a.attr("value")&&a.is(":checked")?t(".link-detail").hide():t(".link-detail").show(),a.each(function(){this.checked&&s.push(t(this).attr("data-code"))}),s.length>5?(o.show({isShowMask:!0,closeIsShow:!0,content:"最多可选择5种过关方式",closeFun:function(){o.hide()}}),e.get(0).checked=!1):i.setSelects(s)});var m=function(e){for(var a=t.trim(e).split("&"),s=0,i=a.length,l=[],n={};i>s;s++)l=a[s].split("="),l.length>0&&(n[l[0]]=2==l.length?l[1]:"");return n},f=null;t(document).on("click","[data-param]",function(e){var a=t(this),s=a.attr("data-param"),l=m(s),n=l.matchid,c="item-active";return"addOrder"!=l.action||i.checkOrderMatchLen(n)||a.hasClass(c)?(t.isFunction(i[l.action])&&(a.hasClass(c)?a.removeClass(c):(a.addClass(c),"addOrder"==l.action&&(f=a)),i[l.action].call(i,l)),void h()):void o.show({isShowMask:!0,closeIsShow:!0,content:"最多可以选择15场比赛",closeFun:function(){o.hide()}})}),n.on("click",".ct-select-timetype",function(e){var a=t(this),s=t.trim(a.attr("data-type"));e.preventDefault(),n.find(".time-type").hide().filter(".time-type-"+s).show(),a.parent(".col-time").removeClass("active"),n.find(".ct-select-timetype").removeClass("active"),a.addClass("active"),n.find(".col-time").find("span").eq(0).text(a.attr("data-text"))}),n.on("click",".ct-select-league",function(e){var a=t(this),s="selected",i=a.attr("data-id");e.preventDefault(),a.hasClass(s)?(n.find(".row-list-league-"+i).hide(),a.removeClass(s)):(n.find(".row-list-league-"+i).show(),a.addClass(s))}),n.on("click",".ct-select-all",function(t){t.preventDefault();var e="selected";n.find(".r").show(),n.find(".ct-select-league").addClass(e)}),n.on("click",".ct-select-none",function(t){t.preventDefault();var e="selected";n.find(".r").hide(),n.find(".ct-select-league").removeClass(e)}),n.on("click",".ct-select-handicap",function(e){var a=t(this),s="game-match-status-handicap";type=t.trim(a.attr("data-type")),cls_all=s+"-all",cls_yes=s+"-yes",cls_no=s+"-no",e.preventDefault(),n.removeClass(cls_all),n.removeClass(cls_yes),n.removeClass(cls_no),n.addClass(s+"-"+type),n.find(".ct-select-handicap").removeClass("active"),a.addClass("active"),n.find(".col-handicap").find("span").eq(0).text(a.attr("data-text"))}),n.on("click",".row-date .ct",function(e){var a,s=t(this),i=s.attr("data-date");e.preventDefault(),a=n.find(".row-list-date-"+i),lists_finish_match=n.find(".isStop"),s.hasClass("ct-open")?(a.show(),t(".finish-box").get(0).checked?lists_finish_match.show():lists_finish_match.hide(),s.text("收起"),s.removeClass("ct-open")):(a.hide(),s.text("展开"),s.addClass("ct-open"))}),t("#J-button-submit").click(function(){var l=t("#J-form"),n=i.getSubmitData(),r=Number(global_sports_config_max.MaxCount),d=Number(global_sports_config_max.MaxAmount);return l.find('[name="is_group_buy"]').val(0),n=a(n),n.betnum>r?(o.show({title:"系统提示",content:'您输入的投注注数超过限制: <span class="c-red">'+r+"</span> 注",closeIsShow:!0,isShowMask:!0,closeFun:function(){o.hide(),c.hide()}}),setTimeout(function(){c.show()},100),!1):n.money*n.multiple>d?(o.show({title:"系统提示",content:'您的投注金额超过限制: <span class="c-yellow">'+e.util.formatMoney(d)+"</span> 元",closeIsShow:!0,isShowMask:!0,closeFun:function(){o.hide(),c.hide()}}),setTimeout(function(){c.show()},100),!1):void(i.getOrders().length>0&&0==n.betnum?s():n.betnum>0&&l.submit())}),t("#J-button-submit-group").click(function(){var l=t("#J-form"),n=i.getSubmitData(),r=Number(global_sports_config_max.MaxCount),d=Number(global_sports_config_max.MaxAmount);return l.find('[name="is_group_buy"]').val(1),n=a(n),n.betnum>r?(o.show({title:"系统提示",content:'您输入的投注注数超过限制: <span class="c-red">'+r+"</span> 注",closeIsShow:!0,isShowMask:!0,closeFun:function(){o.hide(),c.hide()}}),setTimeout(function(){c.show()},100),!1):n.money*n.multiple>d?(o.show({title:"系统提示",content:'您输入的投注金额超过限制: <span class="c-yellow">'+e.util.formatMoney(d)+"</span> 元",closeIsShow:!0,isShowMask:!0,closeFun:function(){o.hide(),c.hide()}}),setTimeout(function(){c.show()},100),!1):void(i.getOrders().length>0&&0==n.betnum?s():n.betnum>0&&l.submit())}),function(){var e=t("#J-panel-main-side"),a=e.offset(),s=a.top,i=a.left,l=t(window),n="panel-main-side-fixed",o=function(){var a=t(window).scrollTop();0>s-a&&!e.hasClass(n)&&(e.addClass(n),e.css("left",i),e.height()>=t(window).height()?e.css("bottom",0):e.css("top",0)),s-a>=0&&e.hasClass(n)&&e.removeClass(n)};l.scroll(o),l.resize(o)}(),n.on("mouseover",".r .col-weather img",function(t){r.setText(this.getAttribute("detail")),r.show(30,0,this)}),n.on("mouseout",".r .col-weather img",function(t){r.hide()}),n.on("mouseover",".time-type",function(t){r.setText(this.getAttribute("detail")),r.show(40,-15,this)}),n.on("mouseout",".time-type",function(t){r.hide()});var p=t(".row-date-select");current_date=t(".current-date"),date_select_box=t(".date-select-box"),date_list=t(".date-list"),arrow_box=t(".arrow-box"),p.on("click",".date-select-box",function(){date_list.hasClass("open-list")?(date_list.removeClass("open-list"),date_list.addClass("close-list"),arrow_box.html('<span class="fa fa-sort-desc"></span>')):(date_list.removeClass("close-list"),date_list.addClass("open-list"),arrow_box.html('<span class="fa fa-sort-asc"></span>'))}),date_list.on("click","li",function(){date_list.removeClass("open-list"),date_list.addClass("close-list"),current_date.html(t(this).text())});var v=t(".finished-match"),b=t(".isStop"),g=t(".ct");v.on("click",".finish-box",function(){var t=g.hasClass("ct-open");t||(this.checked?b.show():b.hide())});var _=t(".link-detail");_.click(function(){var e=t("#J-bets-num").html();Number(e)>0&&!t(":checkbox[value='1_1']").is(":checked")&&(i.analyseMatchDetail(),window.open("./prize_detail"))})}(jQuery,bomao);